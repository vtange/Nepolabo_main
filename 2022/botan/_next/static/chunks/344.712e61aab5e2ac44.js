(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[344],{4467:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return N}});var d,e,f,g,h=c(4111),i=c(1438),j=c(8029),k=c(6626),l=c(5893),m=c(7294),n=c(1864),o=c.n(n),p=c(6486),q=c.n(p),r=c(8349),s=c.n(r);(f=d||(d={}))[f.NONE=0]="NONE",f[f.MINE=1]="MINE",f[f.QUESTION=2]="QUESTION",(g=e||(e={}))[g.RUNNING=0]="RUNNING",g[g.WON=1]="WON",g[g.LOST=2]="LOST";var t="/sweeper",u=o().join(t,"sound_flag.mp3"),v=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(a){var d;return(0,i.Z)(this,c),(d=b.call(this,a)).handleClick=d.handleClick.bind((0,h.Z)(d)),d.getHiddenImage=d.getHiddenImage.bind((0,h.Z)(d)),d.getRevealedImage=d.getRevealedImage.bind((0,h.Z)(d)),d}var f=c.prototype;return f.cycleFlag=function(a){switch(a){case d.NONE:return d.MINE;case d.MINE:return d.QUESTION;case d.QUESTION:return d.NONE}},f.handleClick=function(a){"click"===a.type?this.props.revealed||this.props.flag!==d.NONE||this.props.reveal():"contextmenu"!==a.type||(a.preventDefault(),this.props.revealed||(new Audio(u).play(),this.props.setFlag(this.cycleFlag(this.props.flag))))},f.getHiddenImage=function(){switch(this.props.flag){case d.NONE:return o().join(t,"tile_hidden.png");case d.MINE:return o().join(t,"tile_hidden_flag.png");case d.QUESTION:return o().join(t,"tile_hidden_question.png")}},f.getRevealedImage=function(){var a=this.props.value;switch(a){case -1:if(this.props.status===e.WON)return o().join(t,"tile_revealed_mine_success.png");return o().join(t,"tile_revealed_mine_failure.png");case 0:return o().join(t,"tile_revealed.png");default:return o().join(t,"tile_revealed_".concat(a,".png"))}},f.render=function(){var a=this.props.revealed?this.getRevealedImage():this.getHiddenImage();return(0,l.jsx)("button",{className:s().tile,onClick:this.handleClick,onContextMenu:this.handleClick,children:(0,l.jsx)("picture",{children:(0,l.jsx)("img",{className:s().tile_image,src:a,alt:a})})})},c}(m.Component),w=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(){return(0,i.Z)(this,c),b.apply(this,arguments)}return c.prototype.render=function(){var a=this,b=this.props.state;return(0,l.jsx)("div",{className:s().board,children:b.values.map(function(c,d){return(0,l.jsx)("div",{className:s().row,children:c.map(function(c,e){return(0,l.jsx)(v,{value:c,revealed:b.revealed[d][e],flag:b.flags[d][e],status:a.props.status,setFlag:function(b){return a.props.setFlag(d,e,b)},reveal:function(){return a.props.reveal(d,e)}},e)})},d)})})},c}(m.Component),x=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(a){var d;return(0,i.Z)(this,c),(d=b.call(this,a)).state={curTime:Date.now()},d}var d=c.prototype;return d.update=function(){this.setState({curTime:Date.now()})},d.componentDidMount=function(){var a=this;this.timer=setInterval(function(){return a.update()},1e3)},d.componentWillUnmount=function(){clearInterval(this.timer)},d.format=function(a){return Math.trunc(a).toString().padStart(2,"0")},d.render=function(){var a=Math.floor(((void 0===this.props.doneTime?this.state.curTime:this.props.doneTime)-this.props.startTime)/1e3);return(0,l.jsxs)("a",{children:[this.format(a/60),":",this.format(a%60)]})},c}(m.Component),y=c(4623),z="/sweeper",A=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(a){var d;return(0,i.Z)(this,c),(d=b.call(this,a)).makeStatus=d.makeStatus.bind((0,h.Z)(d)),d}var d=c.prototype;return d.makeStatus=function(a){var b=this.context.lang===y.SQ.ENGLISH;switch(a){case e.RUNNING:return b?"Running":"進行中";case e.LOST:return b?"You Lost!":"負けた！";case e.WON:return b?"You Won!":"勝った！"}},d.getStatusImage=function(a){switch(a){case e.RUNNING:return o().join(z,"state_running.png");case e.LOST:return o().join(z,"state_fail.gif");case e.WON:return o().join(z,"state_success.png")}},d.render=function(){var a=this.getStatusImage(this.props.status);return(0,l.jsx)("picture",{children:(0,l.jsx)("img",{className:s().status,src:a,alt:a})})},c}(m.Component);A.contextType=y.AZ;var B=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(){return(0,i.Z)(this,c),b.apply(this,arguments)}return c.prototype.render=function(){return(0,l.jsxs)("div",{className:s().stats_bar,children:[(0,l.jsxs)("a",{children:[this.props.minesLeft,"/",this.props.minesTotal]}),(0,l.jsx)(A,{status:this.props.status}),(0,l.jsx)(x,{startTime:this.props.startTime,doneTime:this.props.doneTime})]})},c}(m.Component),C=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(){return(0,i.Z)(this,c),b.apply(this,arguments)}var d=c.prototype;return d.makeText=function(a){switch(a){case e.RUNNING:return null;case e.LOST:return(0,l.jsx)("h1",{className:s().result_lose,children:"You Lost!"});case e.WON:return(0,l.jsx)("h1",{className:s().result_win,children:"You Won!"})}},d.render=function(){return(0,l.jsx)("div",{className:s().result,children:this.makeText(this.props.status)})},c}(m.Component),D="/sweeper",E=o().join(D,"sound_reveal_one.mp3"),F=o().join(D,"sound_reveal_many.mp3"),G=o().join(D,"sound_end_fail.mp3"),H=o().join(D,"sound_end_success.mp3");function I(a,b,c){return Array.from(Array(a),function(){return Array(b).fill(c)})}function J(a,b){return a.map(function(a){return a.map(function(a){return b})})}function K(a){return structuredClone(a)}function L(a,b){return{row:a,column:b}}var M=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(a){var f,g,j,k,l,m;return(0,i.Z)(this,c),(f=b.call(this,a)).state={status:e.RUNNING,startTime:Date.now(),doneTime:void 0,values:(g=a.height,j=a.width,k=a.mines,l=I(g,j,0),m=l.flatMap(function(a,b){return a.map(function(a,c){return L(b,c)})}),q().sampleSize(m,k).forEach(function(a){l[a.row][a.column]=-1;for(var b=Math.max(0,a.row-1);b<=Math.min(g-1,a.row+1);b++)for(var c=Math.max(0,a.column-1);c<=Math.min(j-1,a.column+1);c++)(b!==a.row||c!==a.column)&& -1!==l[b][c]&&l[b][c]++}),l),revealed:I(a.height,a.width,!1),flags:I(a.height,a.width,d.NONE)},f.setFlag=f.setFlag.bind((0,h.Z)(f)),f.reveal=f.reveal.bind((0,h.Z)(f)),f}var f=c.prototype;return f.setFlag=function(a,b,c){this.setState(function(d){var e=K(d.flags);return e[a][b]=c,{flags:e}})},f.reveal=function(a,b){var c=this;if(-1===this.state.values[a][b]){new Audio(G).play(),this.setState({status:e.LOST,doneTime:Date.now(),revealed:J(this.state.revealed,!0)});return}this.setState(function(f){var g=K(f.revealed),h=Array.of(L(a,b));g[a][b]=!0;for(var i=1;h.length>0;){var j=h.pop();if(0===f.values[j.row][j.column])for(var k=Math.max(0,j.row-1);k<=Math.min(c.props.height-1,j.row+1);k++)for(var l=Math.max(0,j.column-1);l<=Math.min(c.props.width-1,j.column+1);l++)(k!==j.row||l!==j.column)&& !1===g[k][l]&&f.flags[k][l]===d.NONE&& -1!==f.values[k][l]&&(g[k][l]=!0,i++,h.push(L(k,l)))}var m=g.every(function(a,b){return a.every(function(a,c){return a|| -1===f.values[b][c]})}),n=new Audio(1===i?E:F).play();return m&&n.then(function(){return new Audio(H).play()}),{revealed:m?J(g,!0):g,status:m?e.WON:f.status,doneTime:m?Date.now():void 0}})},f.render=function(){var a=this.state.flags.flatMap(function(a){return a.map(function(a){return a===d.MINE?1:0})}).reduce(function(a,b){return a+b}),b=this.props.mines-a;return(0,l.jsxs)("div",{className:s().game,children:[(0,l.jsx)(B,{minesTotal:this.props.mines,minesLeft:b,startTime:this.state.startTime,doneTime:this.state.doneTime,status:this.state.status}),(0,l.jsx)(C,{status:this.state.status}),(0,l.jsx)(w,{state:this.state,status:this.state.status,setFlag:this.setFlag,reveal:this.reveal})]})},c}(m.Component),N=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(a){var d;return(0,i.Z)(this,c),(d=b.call(this,a)).state={height:3,width:7,mines:3},d.inputWidth=m.createRef(),d.inputHeight=m.createRef(),d.inputMines=m.createRef(),d.games=0,d.handleSubmit=d.handleSubmit.bind((0,h.Z)(d)),d}var d=c.prototype;return d.handleSubmit=function(a){a.preventDefault();var b=this.inputWidth.current.valueAsNumber,c=this.inputHeight.current.valueAsNumber,d=this.inputMines.current.valueAsNumber;d>=b*c&&(console.error("Too many mines!"),d=b*c-1),this.setState({width:b,height:c,mines:d})},d.render=function(){var a=this.context.lang===y.SQ.ENGLISH;return(0,l.jsxs)("div",{className:s().wrapper,children:[(0,l.jsxs)("form",{className:s().config,onSubmit:this.handleSubmit,children:[(0,l.jsxs)("label",{children:[a?"Width:":"横幅:",(0,l.jsx)("input",{className:s().config_input,type:"number",ref:this.inputWidth,defaultValue:this.state.width,min:3,max:40})]}),(0,l.jsxs)("label",{children:[a?"Height:":"高さ:",(0,l.jsx)("input",{className:s().config_input,type:"number",ref:this.inputHeight,defaultValue:this.state.height,min:3,max:40})]}),(0,l.jsxs)("label",{children:[a?"Mines:":"SSRB民:",(0,l.jsx)("input",{className:s().config_input,type:"number",ref:this.inputMines,defaultValue:this.state.mines,min:1})]}),(0,l.jsx)("input",{type:"submit",value:a?"New Game":"ニューゲーム"})]}),(0,l.jsx)(M,{height:this.state.height,width:this.state.width,mines:this.state.mines},this.games++)]})},c}(m.Component);N.contextType=y.AZ},1864:function(a){!function(){"use strict";var b={113:function(a){function b(a){if("string"!=typeof a)throw TypeError("Path must be a string. Received "+JSON.stringify(a))}function c(a,b){for(var c,d="",e=0,f=-1,g=0,h=0;h<=a.length;++h){if(h<a.length)c=a.charCodeAt(h);else if(47===c)break;else c=47;if(47===c){if(f===h-1||1===g);else if(f!==h-1&&2===g){if(d.length<2||2!==e||46!==d.charCodeAt(d.length-1)||46!==d.charCodeAt(d.length-2)){if(d.length>2){var i=d.lastIndexOf("/");if(i!==d.length-1){-1===i?(d="",e=0):e=(d=d.slice(0,i)).length-1-d.lastIndexOf("/"),f=h,g=0;continue}}else if(2===d.length||1===d.length){d="",e=0,f=h,g=0;continue}}b&&(d.length>0?d+="/..":d="..",e=2)}else d.length>0?d+="/"+a.slice(f+1,h):d=a.slice(f+1,h),e=h-f-1;f=h,g=0}else 46===c&& -1!==g?++g:g=-1}return d}var d={resolve:function(){for(var a,d,e="",f=!1,g=arguments.length-1;g>= -1&&!f;g--)g>=0?d=arguments[g]:(void 0===a&&(a=""),d=a),b(d),0!==d.length&&(e=d+"/"+e,f=47===d.charCodeAt(0));return(e=c(e,!f),f)?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(a){if(b(a),0===a.length)return".";var d=47===a.charCodeAt(0),e=47===a.charCodeAt(a.length-1);return(0!==(a=c(a,!d)).length||d||(a="."),a.length>0&&e&&(a+="/"),d)?"/"+a:a},isAbsolute:function(a){return b(a),a.length>0&&47===a.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var a,c=0;c<arguments.length;++c){var e=arguments[c];b(e),e.length>0&&(void 0===a?a=e:a+="/"+e)}return void 0===a?".":d.normalize(a)},relative:function(a,c){if(b(a),b(c),a===c||(a=d.resolve(a),c=d.resolve(c),a===c))return"";for(var e=1;e<a.length&&47===a.charCodeAt(e);++e);for(var f=a.length,g=f-e,h=1;h<c.length&&47===c.charCodeAt(h);++h);for(var i=c.length-h,j=g<i?g:i,k=-1,l=0;l<=j;++l){if(l===j){if(i>j){if(47===c.charCodeAt(h+l))return c.slice(h+l+1);if(0===l)return c.slice(h+l)}else g>j&&(47===a.charCodeAt(e+l)?k=l:0===l&&(k=0));break}var m=a.charCodeAt(e+l);if(m!==c.charCodeAt(h+l))break;47===m&&(k=l)}var n="";for(l=e+k+1;l<=f;++l)(l===f||47===a.charCodeAt(l))&&(0===n.length?n+="..":n+="/..");return n.length>0?n+c.slice(h+k):(h+=k,47===c.charCodeAt(h)&& ++h,c.slice(h))},_makeLong:function(a){return a},dirname:function(a){if(b(a),0===a.length)return".";for(var c=a.charCodeAt(0),d=47===c,e=-1,f=!0,g=a.length-1;g>=1;--g)if(47===(c=a.charCodeAt(g))){if(!f){e=g;break}}else f=!1;return -1===e?d?"/":".":d&&1===e?"//":a.slice(0,e)},basename:function(a,c){if(void 0!==c&&"string"!=typeof c)throw TypeError('"ext" argument must be a string');b(a);var d,e=0,f=-1,g=!0;if(void 0!==c&&c.length>0&&c.length<=a.length){if(c.length===a.length&&c===a)return"";var h=c.length-1,i=-1;for(d=a.length-1;d>=0;--d){var j=a.charCodeAt(d);if(47===j){if(!g){e=d+1;break}}else -1===i&&(g=!1,i=d+1),h>=0&&(j===c.charCodeAt(h)?-1== --h&&(f=d):(h=-1,f=i))}return e===f?f=i:-1===f&&(f=a.length),a.slice(e,f)}for(d=a.length-1;d>=0;--d)if(47===a.charCodeAt(d)){if(!g){e=d+1;break}}else -1===f&&(g=!1,f=d+1);return -1===f?"":a.slice(e,f)},extname:function(a){b(a);for(var c=-1,d=0,e=-1,f=!0,g=0,h=a.length-1;h>=0;--h){var i=a.charCodeAt(h);if(47===i){if(!f){d=h+1;break}continue}-1===e&&(f=!1,e=h+1),46===i?-1===c?c=h:1!==g&&(g=1):-1!==c&&(g=-1)}return -1===c|| -1===e||0===g||1===g&&c===e-1&&c===d+1?"":a.slice(c,e)},format:function(a){var b,c,d,e;if(null===a||"object"!=typeof a)throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof a);return d=(c=a).dir||c.root,e=c.base||(c.name||"")+(c.ext||""),d?d===c.root?d+e:d+"/"+e:e},parse:function(a){b(a);var c,d={root:"",dir:"",base:"",ext:"",name:""};if(0===a.length)return d;var e=a.charCodeAt(0),f=47===e;f?(d.root="/",c=1):c=0;for(var g=-1,h=0,i=-1,j=!0,k=a.length-1,l=0;k>=c;--k){if(47===(e=a.charCodeAt(k))){if(!j){h=k+1;break}continue}-1===i&&(j=!1,i=k+1),46===e?-1===g?g=k:1!==l&&(l=1):-1!==g&&(l=-1)}return -1===g|| -1===i||0===l||1===l&&g===i-1&&g===h+1?-1!==i&&(0===h&&f?d.base=d.name=a.slice(1,i):d.base=d.name=a.slice(h,i)):(0===h&&f?(d.name=a.slice(1,g),d.base=a.slice(1,i)):(d.name=a.slice(h,g),d.base=a.slice(h,i)),d.ext=a.slice(g,i)),h>0?d.dir=a.slice(0,h-1):f&&(d.dir="/"),d},sep:"/",delimiter:":",win32:null,posix:null};d.posix=d,a.exports=d}},c={};function d(a){var e=c[a];if(void 0!==e)return e.exports;var f=c[a]={exports:{}},g=!0;try{b[a](f,f.exports,d),g=!1}finally{g&&delete c[a]}return f.exports}d.ab="//";var e=d(113);a.exports=e}()}}])