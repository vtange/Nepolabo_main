"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[965],{6965:function(a,b,c){c.r(b),c.d(b,{default:function(){return N}});var d,e,f,g,h=c(4111),i=c(1438),j=c(8029),k=c(6626),l=c(5893),m=c(7294),n=c(1864),o=c.n(n),p=c(6486),q=c.n(p),r=c(1058),s=c(8349),t=c.n(s),u={src:"/2022/botan/_next/static/media/tile_hidden.5a51ac88.png",height:160,width:160,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAA1BMVEVhYWGoPJflAAAACXBIWXMAAAsTAAALEwEAmpwYAAAADElEQVQImWNgoA4AAABIAAF7pRHIAAAAAElFTkSuQmCC"};(f=d||(d={}))[f.NONE=0]="NONE",f[f.MINE=1]="MINE",f[f.QUESTION=2]="QUESTION",(g=e||(e={}))[g.RUNNING=0]="RUNNING",g[g.WON=1]="WON",g[g.LOST=2]="LOST";var v=o().join("./","sound_flag.mp3"),w=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(a){var d;return(0,i.Z)(this,c),(d=b.call(this,a)).handleClick=d.handleClick.bind((0,h.Z)(d)),d.getHiddenImage=d.getHiddenImage.bind((0,h.Z)(d)),d.getRevealedImage=d.getRevealedImage.bind((0,h.Z)(d)),d}var f=c.prototype;return f.cycleFlag=function(a){switch(a){case d.NONE:return d.MINE;case d.MINE:return d.QUESTION;case d.QUESTION:return d.NONE}},f.handleClick=function(a){"click"===a.type?this.props.revealed||this.props.flag!==d.NONE||this.props.reveal():"contextmenu"!==a.type||(a.preventDefault(),this.props.revealed||(new Audio(v).play(),this.props.setFlag(this.cycleFlag(this.props.flag))))},f.getHiddenImage=function(){switch(this.props.flag){case d.NONE:return o().join("./","tile_hidden.png");case d.MINE:return o().join("./","tile_hidden_flag.png");case d.QUESTION:return o().join("./","tile_hidden_question.png")}},f.getRevealedImage=function(){var a=this.props.value;switch(a){case -1:if(this.props.status===e.WON)return o().join("./","tile_revealed_mine_success.png");return o().join("./","tile_revealed_mine_failure.png");case 0:return o().join("./","tile_revealed.png");default:return o().join("./","tile_revealed_".concat(a,".png"))}},f.render=function(){var a=this.props.revealed?this.getRevealedImage():this.getHiddenImage();return(0,l.jsx)("button",{className:t().tile,onClick:this.handleClick,onContextMenu:this.handleClick,children:(0,l.jsx)("div",{className:t().tile_image,children:(0,l.jsx)(r.Z,{src:a,alt:a,width:u.width,height:u.height,layout:"responsive"})})})},c}(m.Component),x=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(){return(0,i.Z)(this,c),b.apply(this,arguments)}return c.prototype.render=function(){var a=this,b=this.props.state;return(0,l.jsx)("div",{className:t().board,children:b.values.map(function(c,d){return(0,l.jsx)("div",{className:t().row,children:c.map(function(c,e){return(0,l.jsx)(w,{value:c,revealed:b.revealed[d][e],flag:b.flags[d][e],status:a.props.status,setFlag:function(b){return a.props.setFlag(d,e,b)},reveal:function(){return a.props.reveal(d,e)}},e)})},d)})})},c}(m.Component),y=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(a){var d;return(0,i.Z)(this,c),(d=b.call(this,a)).state={curTime:Date.now()},d}var d=c.prototype;return d.update=function(){this.setState({curTime:Date.now()})},d.componentDidMount=function(){var a=this;this.timer=setInterval(function(){return a.update()},1e3)},d.componentWillUnmount=function(){clearInterval(this.timer)},d.format=function(a){return Math.trunc(a).toString().padStart(2,"0")},d.render=function(){var a=Math.floor(((void 0===this.props.doneTime?this.state.curTime:this.props.doneTime)-this.props.startTime)/1e3);return(0,l.jsxs)("a",{children:[this.format(a/60),":",this.format(a%60)]})},c}(m.Component),z=c(4623),A=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(a){var d;return(0,i.Z)(this,c),(d=b.call(this,a)).makeStatus=d.makeStatus.bind((0,h.Z)(d)),d}var d=c.prototype;return d.makeStatus=function(a){var b=this.context.lang===z.SQ.ENGLISH;switch(a){case e.RUNNING:return b?"Running":"進行中";case e.LOST:return b?"You Lost!":"負けた！";case e.WON:return b?"You Won!":"勝った！"}},d.getStatusImage=function(a){switch(a){case e.RUNNING:return o().join("./","state_running.png");case e.LOST:return o().join("./","state_fail.png");case e.WON:return o().join("./","state_success.png")}},d.render=function(){var a=this.getStatusImage(this.props.status);return(0,l.jsx)("picture",{children:(0,l.jsx)("img",{className:t().status,src:a,alt:a})})},c}(m.Component);A.contextType=z.AZ;var B=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(){return(0,i.Z)(this,c),b.apply(this,arguments)}return c.prototype.render=function(){return(0,l.jsxs)("div",{className:t().stats_bar,children:[(0,l.jsxs)("a",{children:[this.props.minesLeft,"/",this.props.minesTotal]}),(0,l.jsx)(A,{status:this.props.status}),(0,l.jsx)(y,{startTime:this.props.startTime,doneTime:this.props.doneTime})]})},c}(m.Component),C=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(){return(0,i.Z)(this,c),b.apply(this,arguments)}var d=c.prototype;return d.makeText=function(a){switch(a){case e.RUNNING:return null;case e.LOST:return(0,l.jsx)("h1",{className:t().result_lose,children:"You Lost!"});case e.WON:return(0,l.jsx)("h1",{className:t().result_win,children:"You Won!"})}},d.render=function(){return(0,l.jsx)("div",{className:t().result,children:this.makeText(this.props.status)})},c}(m.Component),D="/sweeper",E=o().join(D,"sound_reveal_one.mp3"),F=o().join(D,"sound_reveal_many.mp3"),G=o().join(D,"sound_end_fail.mp3"),H=o().join(D,"sound_end_success.mp3");function I(a,b,c){return Array.from(Array(a),function(){return Array(b).fill(c)})}function J(a,b){return a.map(function(a){return a.map(function(a){return b})})}function K(a){return structuredClone(a)}function L(a,b){return{row:a,column:b}}var M=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(a){var f,g,j,k,l,m;return(0,i.Z)(this,c),(f=b.call(this,a)).state={status:e.RUNNING,startTime:Date.now(),doneTime:void 0,values:(g=a.height,j=a.width,k=a.mines,l=I(g,j,0),m=l.flatMap(function(a,b){return a.map(function(a,c){return L(b,c)})}),q().sampleSize(m,k).forEach(function(a){l[a.row][a.column]=-1;for(var b=Math.max(0,a.row-1);b<=Math.min(g-1,a.row+1);b++)for(var c=Math.max(0,a.column-1);c<=Math.min(j-1,a.column+1);c++)(b!==a.row||c!==a.column)&& -1!==l[b][c]&&l[b][c]++}),l),revealed:I(a.height,a.width,!1),flags:I(a.height,a.width,d.NONE)},f.setFlag=f.setFlag.bind((0,h.Z)(f)),f.reveal=f.reveal.bind((0,h.Z)(f)),f}var f=c.prototype;return f.setFlag=function(a,b,c){this.setState(function(d){var e=K(d.flags);return e[a][b]=c,{flags:e}})},f.reveal=function(a,b){var c=this;if(-1===this.state.values[a][b]){new Audio(G).play(),this.setState({status:e.LOST,doneTime:Date.now(),revealed:J(this.state.revealed,!0)});return}this.setState(function(f){var g=K(f.revealed),h=Array.of(L(a,b));g[a][b]=!0;for(var i=1;h.length>0;){var j=h.pop();if(0===f.values[j.row][j.column])for(var k=Math.max(0,j.row-1);k<=Math.min(c.props.height-1,j.row+1);k++)for(var l=Math.max(0,j.column-1);l<=Math.min(c.props.width-1,j.column+1);l++)(k!==j.row||l!==j.column)&& !1===g[k][l]&&f.flags[k][l]===d.NONE&& -1!==f.values[k][l]&&(g[k][l]=!0,i++,h.push(L(k,l)))}var m=g.every(function(a,b){return a.every(function(a,c){return a|| -1===f.values[b][c]})}),n=new Audio(1===i?E:F).play();return m&&n.then(function(){return new Audio(H).play()}),{revealed:m?J(g,!0):g,status:m?e.WON:f.status,doneTime:m?Date.now():void 0}})},f.render=function(){var a=this.state.flags.flatMap(function(a){return a.map(function(a){return a===d.MINE?1:0})}).reduce(function(a,b){return a+b}),b=this.props.mines-a;return(0,l.jsxs)("div",{className:t().game,children:[(0,l.jsx)(B,{minesTotal:this.props.mines,minesLeft:b,startTime:this.state.startTime,doneTime:this.state.doneTime,status:this.state.status}),(0,l.jsx)(C,{status:this.state.status}),(0,l.jsx)(x,{state:this.state,status:this.state.status,setFlag:this.setFlag,reveal:this.reveal})]})},c}(m.Component),N=function(a){(0,j.Z)(c,a);var b=(0,k.Z)(c);function c(a){var d;return(0,i.Z)(this,c),(d=b.call(this,a)).state={height:3,width:7,mines:3},d.inputWidth=m.createRef(),d.inputHeight=m.createRef(),d.inputMines=m.createRef(),d.games=0,d.handleSubmit=d.handleSubmit.bind((0,h.Z)(d)),d}var d=c.prototype;return d.handleSubmit=function(a){a.preventDefault();var b=this.inputWidth.current.valueAsNumber,c=this.inputHeight.current.valueAsNumber,d=this.inputMines.current.valueAsNumber;d>=b*c&&(console.error("Too many mines!"),d=b*c-1),this.setState({width:b,height:c,mines:d})},d.render=function(){var a=this.context.lang===z.SQ.ENGLISH;return(0,l.jsxs)("div",{className:t().wrapper,children:[(0,l.jsxs)("form",{className:t().config,onSubmit:this.handleSubmit,children:[(0,l.jsxs)("label",{children:[a?"Width:":"横幅:",(0,l.jsx)("input",{className:t().config_input,type:"number",ref:this.inputWidth,defaultValue:this.state.width,min:3,max:40})]}),(0,l.jsxs)("label",{children:[a?"Height:":"高さ:",(0,l.jsx)("input",{className:t().config_input,type:"number",ref:this.inputHeight,defaultValue:this.state.height,min:3,max:40})]}),(0,l.jsxs)("label",{children:[a?"Mines:":"SSRB民:",(0,l.jsx)("input",{className:t().config_input,type:"number",ref:this.inputMines,defaultValue:this.state.mines,min:1})]}),(0,l.jsx)("input",{type:"submit",value:a?"New Game":"ニューゲーム"})]}),(0,l.jsx)(M,{height:this.state.height,width:this.state.width,mines:this.state.mines},this.games++)]})},c}(m.Component);N.contextType=z.AZ}}])